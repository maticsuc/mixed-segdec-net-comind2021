# Hyper parameters testing

[Članek](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=9680172)

[Pregled vseh člankov](https://docs.google.com/spreadsheets/d/1AUmJ-JQtpvQt3Rs0maRirAxbBW6zBOBaPq1kVDSdvK0/edit?usp=sharing)

[Dataset](https://github.com/fyangneil/pavement-crack-detection)

## Model architecture

![architecture](./arhitektura_v2.png)

## Dataset

| Parameter         | Value       |
| -----------       | ----------- |
| Input channels    | 3           |
| Input height      | 640         |
| Input width       | 360         |
| Train samples     | 1896        |
| Test samples      | 1124        |
| Validation samples| 348         |

| Set         | Positives   | Negatives   |  Sum        |
| ----------- | ----------- | ----------- | ----------- |
| Train       | 1896        | 0           | 1896        |
| Test        | 1124        | 0           | 1124        |
| Validation  | 348         | 0           | 348         |
| **Sum**     | 3368        | 0           | 3368        |

## Run parameters

| Parameter                      | Value       |
| -----------                    | ----------- |
| Batch size                     | 1           |
| Epochs                         | 50          |
| Learning rate                  | 1.0         |
| Delta CLS Loss                 | 0.01        |
| Dilate                         | 1           |
| Dynamically balanced loss      | True        |
| Gradien-flow adjustment        | True        |
| Frequency-of-use sampling      | False       |
| Weighted segmentation loss     | False       |
| Use best model                 | True        |
| Best model type                | seg         |
| Validate                       | True        |
| Validate on test               | False       |

## Results
| Run Name    | Optimizer   | Learning rate | Delta CLS Loss | Scheduler   | Epochs      | Pr        | Re       | F1       | threshold | TP   | FN   |
| ----------- | ----------- | -----------   | -----------    | ----------- | ----------- | ----------| ---------| ---------| ----------| -----| -----|
| hp1         | Adam        | 0.1           | 0.01           | -           | 25          | 0.713975  | 0.790963 | 0.724785 | 0.205     | 0    | 1124 |
| hp2         | Adam        | 0.01          | 0.01           | -           | 25          | 0.738375  | 0.798912 | 0.750250 | 0.375     | 0    | 1124 |
| hp3         | Adam        | 0.001         | 0.01           | -           | 100         | 0.743568  | 0.810500 | 0.758308 | 0.305     | 1120 | 4    |
| hp4         | Adam        | 0.0001        | 0.01           | -           | 25          | 0.737910  | 0.797685 | 0.741322 | 0.315     | 0    | 1124 |
| hp5         | Adam        | 0.00001       | 0.01           | -           | 25          | 0.747797  | 0.736870 | 0.714887 | 0.815     | 1118 | 6    |
| hp6         | Adam        | 0.00005       | 0.01           | -           | 25          | 0.730461  | 0.801501 | 0.740753 | 0.44      | 0    | 1124 |
| hp7         | Adam        | 0.001         | 0.001          | -           | 25          | 0.754511  | 0.792581 | 0.755729 | 0.24      | 0    | 1124 |
| hp8         | Adam        | 0.001         | 0.0001         | -           | 25          | 0.744470  | 0.791897 | 0.748976 | 0.41      | 1110 | 14   |
| hp9         | Adam        | 0.001         | 0.00005        | -           | 25          | 0.738261  | 0.807130 | 0.753557 | 0.35      | 1094 | 30   |
| hp10        | Adam        | 0.01          | 0.001          | -           | 25          | 0.747729  | 0.794068 | 0.753376 | 0.27      | 0    | 1124 |
| hp11        | Adam        | 0.01          | 0.0001         | -           | 25          | 0.745214  | 0.804389 | 0.755747 | 0.415     | 0    | 1124 |
| hp12        | Adam        | 0.01          | 0.00005        | -           | 25          | 0.731943  | 0.813634 | 0.753952 | 0.325     | 0    | 1124 |
| hp13        | Adam        | 0.0001        | 0.001          | -           | 25          | 0.722238  | 0.803690 | 0.737193 | 0.445     | 0    | 1124 |
| hp14        | Adam        | 0.0001        | 0.0001         | -           | 25          | 0.714880  | 0.809729 | 0.735113 | 0.315     | 1123 | 1    |
| hp15        | Adam        | 0.01          | 0.0001         | 1 0.95      | 25          | 0.730501  | 0.803628 | 0.747251 | 0.32      | 0    | 1124 |
| hp16        | Adam        | 0.01          | 0.0001         | 5 0.95      | 25          | 0.737093  | 0.772502 | 0.730841 | 0.455     | 0    | 1124 |
| hp17        | Adam        | 0.01          | 0.0001         | 5 0.9       | 25          | 0.742401  | 0.794502 | 0.749880 | 0.46      | 0    | 1124 |
| hp18        | SGD         | 0.1           | 0.1            | -           | 25          | 0.742203  | 0.800632 | 0.752124 | 0.405     | 1107 | 17   |
| hp19        | SGD         | 0.1           | 0.01           | -           | 25          | 0.736876  | 0.809551 | 0.752436 | 0.355     | 1122 | 2    |
| hp20        | SGD         | 0.1           | 0.001          | -           | 25          | 0.747888  | 0.792330 | 0.751414 | 0.265     | 1120 | 4    |
| hp21        | SGD         | 0.1           | 0.0001         | -           | 25          | 0.740578  | 0.804901 | 0.753908 | 0.26      | 1123 | 1    |
| hp22        | SGD         | 0.01          | 0.1            | -           | 25          | 0.738417  | 0.790941 | 0.741860 | 0.325     | 1124 | 0    |
| hp23        | SGD         | 0.01          | 0.01           | -           | 25          | 0.726782  | 0.776202 | 0.730034 | 0.475     | 1123 | 1    |
| hp24        | SGD         | 0.01          | 0.001          | -           | 25          | 0.730478  | 0.785937 | 0.735559 | 0.415     | 1119 | 5    |
| hp25        | SGD         | 0.01          | 0.0001         | -           | 25          | 0.721961  | 0.792253 | 0.732749 | 0.435     | 1120 | 4    |
| hp26        | SGD         | 0.001         | 0.1            | -           | 25          | 0.695210  | 0.762708 | 0.697371 | 0.405     | 1124 | 0    |
| hp27        | SGD         | 0.001         | 0.01           | -           | 25          | 0.700777  | 0.752429 | 0.697139 | 0.405     | 1123 | 1    |
| hp28        | SGD         | 0.001         | 0.001          | -           | 25          | 0.699725  | 0.748698 | 0.695805 | 0.42      | 1124 | 0    |
| hp29        | SGD         | 0.001         | 0.0001         | -           | 25          | 0.697632  | 0.757185 | 0.694518 | 0.415     | 1124 | 0    |
| hp30        | SGD         | 0.1           | 0.01           | 5 0.95      | 25          | 0.736445  | 0.802163 | 0.748540 | 0.43      | 1116 | 8    |
| hp31        | SGD         | 0.1           | 0.01           | 10 0.95     | 25          |   |  |  |       |  |     |
| hp32        | SGD         | 0.1           | 0.1            | 5 0.95      | 25          |   |  |  |       |  |     |
| hp33        | SGD         | 0.1           | 0.1            | 10 0.95     | 25          |   |  |  |       |  |     |