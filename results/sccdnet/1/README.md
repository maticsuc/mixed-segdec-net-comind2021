# Results of training on Sccdnet dataset

[Članek](https://www.mdpi.com/2076-3417/11/11/5074)

[Pregled vseh člankov](https://docs.google.com/spreadsheets/d/1AUmJ-JQtpvQt3Rs0maRirAxbBW6zBOBaPq1kVDSdvK0/edit?usp=sharing)

[Dataset](https://github.com/543630836/SCCDNet_crack)

## Dataset

| Parameter         | Value       |
| -----------       | ----------- |
| Input channels    | 3           |
| Input height      | 448         |
| Input width       | 448         |

| Set         | Positives   | Negatives   | Sum         |
| ----------- | ----------- | ----------- | ----------- |
| Train       | 4935        | 1229        | 6164        |
| Test        | 787         | 218         | 1005        |

## Run parameters

| Parameter                      | Value       |
| -----------                    | ----------- |
| Augmentation                   | True        |
| Batch size                     | 10          |
| BCE Loss weight                | True        |
| Best model type                | both        |
| Optimizer                      | Adam        |
| Learning rate                  | 0.001       |
| Delta CLS Loss                 | 0.1         |
| Epochs                         | 100         |
| Dilate                         | 1           |
| Weighted segmentation loss     | False       |
| Dynamically balanced loss      | False       |
| Gradien-flow adjustment        | True        |
| Frequency-of-use sampling      | False       |
| Validate                       | True        |
| Validate on test               | False       |
| Validataton N epochs           | 2           |
| Use best model                 | True        |

# Datasets

| Set         | Train    | Test     | Opis                                                                    |
| ----------- | -------- | -------- | ----------------------------------------------------------------------- |
| Original    | 6164     | 1005     | Originalen dataset iz članka                                            |
| Opening     | 6164     | 1005     | Opening narejen na originalnem članku                                   |
| Clean       | 2915     | 432      | Odstranjeni slabi primeri iz originalnega dataseta - samo za testiranje |

# Runs

| Set         | Črnenje  | Beljenje |
| ----------- | -------- | -------- |
| Run 1       | True     | 0.9      |
| Run 2       | False    | False    |


### Decision

| Run                  | Precision | Recall   | F1       | Accuracy | TP   | FP   | FN   | TN   | Dataset   |
| ---------------------| ----------| ---------| ---------|----------|------|------|------|------|-----------|
| Run 1 best seg+dec   | 0.998729  | 0.998729 | 0.998729 | 0.998010 | 786  | 1    | 1    | 217  | Opening   |
| Run 1 best seg+dec   | 0.998729  | 0.998729 | 0.998729 | 0.998010 | 786  | 1    | 1    | 217  | Original  |
| Run 1 best seg+dec   | 0.995475  | 1.0      | 0.997732 | 0.997685 | 220  | 1    | 0    | 211  | Clean     |
| Run 1 best seg       | 0.998726  | 0.996188 | 0.997455 | 0.996020 | 784  | 1    | 3    | 217  | Opening   |
| Run 1 best seg       | 0.998726  | 0.996188 | 0.997455 | 0.996020 | 784  | 1    | 3    | 217  | Original  |
| Run 1 best seg       | 0.995455  | 0.995455 | 0.995455 | 0.995370 | 219  | 1    | 1    | 211  | Clean     |
| Run 1 - brez SSE     | 0.998728  | 0.997459 | 0.998093 | 0.997015 | 785  | 1    | 2    | 217  | Opening   |
| Run 2                | 0.998729  | 0.998729 | 0.998729 | 0.998010 | 786  | 1    | 1    | 217  | Opening   |
| Run 2                | 0.991173  | 0.998729 | 0.994937 | 0.992040 | 786  | 7    | 1    | 211  | Original  |

### Segmentation

| Run                  | Precision | Recall   | F1       | Dice     | IoU      | Dataset  |
| ---------------------| ----------| ---------| ---------|----------|----------|----------|
| SCCDNet Članek       | 0.7294    | 0.8296   | 0.7763   | 0.7541   | 0.6402   | Original |
| Run 1 best seg+dec   | 0.761628  | 0.861588 | 0.808530 | 0.797259 | 0.692042 | Opening  |
| Run 1 best seg+dec   | 0.748002  | 0.775889 | 0.761690 | 0.743794 | 0.622765 | Original |
| Run 1 best seg+dec   | 0.770487  | 0.908299 | 0.833736 | 0.812214 | 0.743119 | Clean    |
| Run 1 best seg       | 0.784680  | 0.865563 | 0.823140 | 0.812680 | 0.713362 | Opening  |
| Run 1 best seg       | 0.765339  | 0.771863 | 0.768588 | 0.750971 | 0.630939 | Original |
| Run 1 best seg       | 0.780763  | 0.906779 | 0.839066 | 0.819631 | 0.751020 | Clean    |
| Run 1 - brez SSE     | 0.776441  | 0.837102 | 0.805632 | 0.792951 | 0.689838 | Opening  |
| Run 2                | 0.773732  | 0.843309 | 0.807024 | 0.785855 | 0.685849 | Opening  |
| Run 2                | 0.727615  | 0.758179 | 0.742583 | 0.700874 | 0.580615 | Original |

# 5-fold cross validation

Črnenje + Beljenje

| Run      | FP      | FN       | F1       | Dice     | IoU      | Dataset  |
| ---------| --------| ---------| ---------|----------|----------|----------|
| Fold 1   | 8       | 5        | 0.784687 | 0.753528 | 0.649928 | Opening  |
| Fold 2   | 3       | 5        | 0.796758 | 0.768059 | 0.669756 | Opening  |
| Fold 3   | 8       | 4        | 0.800613 | 0.776133 | 0.674688 | Opening  |
| Fold 4   | 9       | 1        | 0.806646 | 0.782884 | 0.683474 | Opening  |
| Fold 5   | 13      | 5        | 0.792372 | 0.766026 | 0.663960 | Opening  |
| Fold 1   | 8       | 5        | 0.729887 | 0.694900 | 0.574542 | Original |
| Fold 2   | 3       | 5        | 0.736729 | 0.695658 | 0.575168 | Original |
| Fold 3   | 8       | 4        | 0.743013 | 0.709577 | 0.589327 | Original |
| Fold 4   | 9       | 1        | 0.745337 | 0.709324 | 0.590062 | Original |
| Fold 5   | 13      | 5        | 0.735733 | 0.698533 | 0.578679 | Original |


| Run          | m-F1     | m-Dice   | m-IoU    | Dataset  |
| -------------| ---------|----------|----------|----------|
| 5-Fold Cross | 0.796215 | 0.769326 | 0.668361 | Opening  |
| 5-Fold Cross | 0.738140 | 0.701598 | 0.581556 | Original |


Črnenje + Beljenje

| Seed | Precision | Recall   | F1       | Dice     | IoU      | FP | FN | seg_FP | seg_FN | Počrnjeni | Pobeljeni | Dataset |
| -----| ----------| ---------| ---------|----------|----------|----|----|--------|--------|-----------|-----------|---------|
| 101  | 0.792265  | 0.863522 | 0.826360 | 0.816764 | 0.718027 | 0  | 2  | 0      | 2      | 1         | 1         | Opening |
| 102  | 0.784680  | 0.865563 | 0.823140 | 0.812680 | 0.713362 | 1  | 3  | 27     | 1      | 28        | 0         | Opening |
| 103  | 0.790072  | 0.856539 | 0.821964 | 0.812904 | 0.713713 | 0  | 3  | 7      | 2      | 8         | 0         | Opening |
| 104  | 0.775150  | 0.868448 | 0.819151 | 0.810403 | 0.709515 | 1  | 2  | 28     | 0      | 29        | 0         | Opening |
| 105  | 0.780280  | 0.864093 | 0.820050 | 0.810717 | 0.711687 | 0  | 2  | 40     | 0      | 42        | 1         | Opening |
| mean | 0.784489  | 0.863633 | 0.822133 | 0.812694 | 0.713261 |    |    |        |        |           |           |         |
| mean | 0.006271  | 0.003936 | 0.002535 | 0.002270 | 0.002809 |    |    |        |        |           |           |         |


Črnenje

| Seed | Precision | Recall   | F1       | Dice     | IoU      | FP | FN | seg_FP | seg_FN | Dataset | Počrnjeni |
| -----| ----------| ---------| ---------|----------|----------|----|----|--------|--------|---------|-----------|
| 101  | 0.792487  | 0.863514 | 0.826477 | 0.816748 | 0.718019 | 0  | 2  | 0      | 2      | Opening | 1         |
| 102  | 0.784680  | 0.865563 | 0.823140 | 0.812680 | 0.713362 | 1  | 3  | 27     | 1      | Opening | 28        |
| 103  | 0.790072  | 0.856539 | 0.821964 | 0.812904 | 0.713713 | 0  | 3  | 7      | 2      | Opening | 8         |
| 104  | 0.775150  | 0.868448 | 0.819151 | 0.810403 | 0.709515 | 1  | 2  | 19     | 0      | Opening | 29        |
| 105  | 0.780280  | 0.864093 | 0.820050 | 0.810717 | 0.711463 | 0  | 2  | 37     | 1      | Opening | 42        |
| mean | 0.784534  | 0.863631 | 0.822156 | 0.812690 | 0.713214 |    |    |        |        |         |           |
| std  | 0.006326  | 0.003936 | 0.002575 | 0.002264 | 0.002832 |    |    |        |        |         |           |

Beljenje

| Seed | Precision | Recall   | F1       | Dice     | IoU      | FP | FN | seg_FP | seg_FN | Dataset | Adjusted thresholds |
| -----| ----------| ---------| ---------|----------|----------|----|----|--------|--------|---------|---------------------|
| 101  | 0.791696  | 0.863669 | 0.826118 | 0.816888 | 0.718094 | 0  | 2  | 0      | 2      | Opening | 1                   |
| 102  | 0.769198  | 0.856149 | 0.810348 | 0.790814 | 0.691977 | 1  | 3  | 23     | 1      | Opening | 0                   |
| 103  | 0.782980  | 0.856845 | 0.818249 | 0.806392 | 0.707194 | 0  | 3  | 7      | 2      | Opening | 0                   |
| 104  | 0.766637  | 0.849173 | 0.805797 | 0.786424 | 0.687067 | 1  | 2  | 19     | 0      | Opening | 1                   |
| 105  | 0.757415  | 0.846085 | 0.799298 | 0.774816 | 0.675567 | 0  | 2  | 37     | 1      | Opening | 1                   |
| mean | 0.773585  | 0.854384 | 0.811962 | 0.795067 | 0.695980 | 0  | 2  |        |        | Opening |                     |
| std  | 0.012209  | 0.006187 | 0.009391 | 0.014882 | 0.015013 | 0  | 2  |        |        | Opening |                     |

Brez vklopljenih dodatkov

| Seed | Precision | Recall   | F1       | Dice     | IoU      | FP | FN | seg_FP | seg_FN | Dataset |
| -----| ----------| ---------| ---------|----------|----------|----|----|--------|--------|---------|
| 101  | 0.791696  | 0.863669 | 0.826118 | 0.816888 | 0.718094 | 0  | 2  | 0      | 2      | Opening |
| 102  | 0.769197  | 0.856149 | 0.810347 | 0.790814 | 0.691977 | 1  | 3  | 23     | 1      | Opening |
| 103  | 0.782980  | 0.856845 | 0.818249 | 0.806392 | 0.707194 | 0  | 3  | 7      | 2      | Opening |
| 104  | 0.766637  | 0.849173 | 0.805797 | 0.787420 | 0.688062 | 1  | 2  | 19     | 0      | Opening |
| 105  | 0.758049  | 0.845749 | 0.799501 | 0.774473 | 0.675366 | 0  | 2  | 37     | 1      | Opening |
| mean | 0.773712  | 0.854317 | 0.812002 | 0.795197 | 0.696139 |    |    |        |        |         |
| std  | 0.012042  | 0.006278 | 0.009336 | 0.014866 | 0.014955 |    |    |        |        |         |

Brez klasifikacijske glave - samo U-Net

| Seed | Precision | Recall   | F1       | Dice     | IoU      | Dataset |
| -----| ----------| ---------| ---------|----------|----------|---------|
| 101  | 0.781548  | 0.848244 | 0.813531 | 0.800538 | 0.701784 | Opening |
| 102  | 0.787006  | 0.844356 | 0.814673 | 0.802960 | 0.702702 | Opening |
| 103  |           |          |          |          |          | Opening |
| 104  | 0.789538  | 0.837291 | 0.812713 | 0.797225 | 0.696314 | Opening |
| 105  |           |          |          |          |          | Opening |
| mean | 0.786031  | 0.843297 | 0.813639 | 0.800241 | 0.700267 |         |
| std  | 0.003334  | 0.004534 | 0.000804 | 0.002351 | 0.00282  |         |